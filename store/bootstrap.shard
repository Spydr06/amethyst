with import ./geode.shard; 
config:
let
    pkgmgr = import ./pkgs.shard;

    bootstrapPkg = pkg: (builtins.seqList (pkgmgr.installPipeline config pkg));

    bootstrapPkgs = pkgList: builtins.map bootstrapPkg pkgList;

    createIso = file: (util.io.logMajor $ "Creating ISO `" + file + "`");
in 
    builtins.seqList [
        (bootstrapPkgs config.environment.packages)
        (createIso "amethyst.iso")
    ]

